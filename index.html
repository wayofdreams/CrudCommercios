<!DOCKTYPE html>
<html>
<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <link rel="stylesheet" href="css/main.css">
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAVNE9sptlriRty1HEF6kLBYLGvCVV7zcE&callback=initMap" async defer></script>
    <script src="js/Model.js"></script>
    <script src=js/ComercioModal.js></script>
</head>
    
<body>
    <div class="container comerciosContainer">
      <div class="row">
        <div class="col-md-12">
          <table class="table table-bordered" id="comerciosTable">
            <thead><tr><th>Nombre</th><th>Codigo</th><th>Descripcion</th><th>Ubicacion</th></tr></thead>
            <tbody id="comerciosTableBody"></tbody>
          </table>
        </div>
      </div>
      <div class="row">
        <div class="col-md-12">
             <!-- Button trigger modal -->
          <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal">
            Create comercio
          </button>
        </div>
      </div>
    </div>
    
 

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" >
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
        <div class="container">
            <div class="row">
                <div id="map" class="" style="width: 300px; height: 300px"></div>
            </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>
</body>

<script>

function initMap() {
  // Create a map object and specify the DOM element for display.
  var map = new google.maps.Map(document.getElementById('map'), {
    center: {lat: -34.397, lng: 150.644},
    scrollwheel: false,
    zoom: 8
  });
}


function resizeMap() {
   if(typeof map =="undefined") return;
   setTimeout( resizingMap , 400);
}

function resizingMap() {
   if(typeof map =="undefined") return;
   var center = map.getCenter;
   google.maps.event.trigger(map, "resize");
   map.setCenter(center); 
}

$('#myModal').on('show.bs.modal', function() {
   //Must wait until the render of the modal appear, thats why we use the resizeMap and NOT resizingMap!! ;-)
   resizeMap();
})

function updateCommerciosTable(){
  var table = document.getElementById("comerciosTableBody");

  for(codigo in comercios){
    comercio = comercios[codigo];
    var nombre = document.createElement("td");
    nombre.innerHTML = comercio["nombre"];
    var codigo = document.createElement("td");
    codigo.innerHTML = comercio["codigo"];
    var descripcion = document.createElement("td");
    descripcion.innerHTML = comercio["descripcion"];
    var ubicacion = document.createElement("td");
    ubicacion.innerHTML = "lat: " + comercio["ubicacion"]["lat"] + ", lng: " + comercio["ubicacion"]["lng"];

    var row = document.createElement("tr");

    row.appendChild(nombre);
    row.appendChild(codigo);
    row.appendChild(descripcion);
    row.appendChild(ubicacion);

    table.appendChild(row);
  }

}

</script>
</html>